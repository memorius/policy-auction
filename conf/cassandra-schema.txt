
/* TODO: set replication_factor to 3 once we have an actual cluster */
create keyspace policy_auction
    with placement_strategy = 'org.apache.cassandra.locator.SimpleStrategy'
    and strategy_options=[{replication_factor:1}];

use policy_auction;

create column family policies
    with comment = 'Policies keyed by policyID, and votes given them by each user'
    and comparator = UTF8Type
    and column_metadata = [{
            column_name: short_name,
            validation_class: UTF8Type
        }, {
            column_name: description,
            validation_class: UTF8Type
        }
    ];

create column family users
    with comment = 'Users by userID'
    and comparator = UTF8Type
    and column_metadata = [{
            column_name: password,
            validation_class: UTF8Type
        }, {
            column_name: name,
            validation_class: UTF8Type
        }
    ];

create column family users_by_name
    with comment = 'Lookup of userID from user name'
    and comparator = UTF8Type
    and column_metadata = [{
            column_name: user_id,
            validation_class: TimeUUIDType
        }
    ];

create column family memcache_string
    with comment = 'Single-row lookup tables for in-memory small datasets, with string-named columns'
    and key_validation_class = UTF8Type
    and comparator = UTF8Type
    and default_validation_class = BytesType
    and keys_cached = 1.0
    and rows_cached = 1.0
    and key_cache_save_period = 0
    and row_cache_save_period = 0;

create column family memcache_timeuuid
    with comment = 'Single-row lookup tables for in-memory small datasets, with TimeUUID-named columns'
    and key_validation_class = UTF8Type
    and comparator = TimeUUIDType
    and default_validation_class = BytesType
    and keys_cached = 1.0
    and rows_cached = 1.0
    and key_cache_save_period = 0
    and row_cache_save_period = 0;

create column family misc_string
    with comment = 'Single-row lookup tables for non-in-memory datasets, with string-named columns'
    and key_validation_class = UTF8Type
    and comparator = UTF8Type
    and default_validation_class = BytesType
    and keys_cached = 1.0
    and rows_cached = 0
    and row_cache_save_period = 0
    and key_cache_save_period = 0
    and row_cache_save_period = 0;


/* TODO: set replication_factor to 2 once we have an actual cluster */
create keyspace policy_auction_logs
    with placement_strategy = 'org.apache.cassandra.locator.SimpleStrategy'
    and strategy_options=[{replication_factor:1}];

use policy_auction_logs;

create column family log
    with comment = 'Application log'
    and column_type = Super
    and key_validation_class = UTF8Type
    and comparator = TimeUUIDType
    and subcomparator = UTF8Type
    and default_validation_class = UTF8Type
    and read_repair_chance = 1.0
    and keys_cached = 100
    and rows_cached = 0
    and key_cache_save_period = 0
    and row_cache_save_period = 0;
